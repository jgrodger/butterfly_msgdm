---
title: "Supplementary materials for Rodger et al. XXX"
output: html_document
date: "2024-04-24"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
```

```{r}
here::i_am("Scripts/Rmd_Scripts/supp_materials_report.Rmd")

library(rmarkdown)
library(readr)
library(knitr)
library(knitrProgressBar)
library(tictoc)
library(here)
library(conflicted)
library(here)
```
https://epirhandbook.com/en/reports-with-r-markdown.html
https://bookdown.org/yihui/rmarkdown/r-code.html#figures
https://rmarkdown.rstudio.com/articles_report_from_r_script.html
https://uoepsy.github.io/scs/rmd-bootcamp/06-figs.html
http://zevross.com/blog/2017/06/19/tips-and-tricks-for-working-with-images-and-figures-in-r-markdown-documents/

#### The datasets we are reporting on 
```{r}

datasets <- c("all_species", "wc", "hs", "hs_no_zeros")
dataset_names <- c("All Butterfly Species", "Wider Countryside Species", "Habitat Specialists including sites with no species", "Habitat Specialists excluding sites with no species" )
```


```{r}
# to use loop for figures, it may work in pander
#https://github.com/Rapporter/pander/blob/master/vignettes/pander.Rmd
#https://stackoverflow.com/questions/36373630/create-a-loop-that-includes-both-a-code-chunk-and-text
```


# Zeta declines
### Zeta orders 1 to 10

#### All species
```{r fig.cap = "Figure S3. Zeta diversity decline for all butterfly species, zeta orders 1 to 10", out.width='100%'}
knitr::include_graphics(here("./Output/Spatial/zeta_declines_decays/all_species/all_species_zeta_decline_to_10.png"))
```

#### Wider countryside species
```{r fig.cap = "Figure S4. Zeta diversity decline for wider countryside species, zeta orders 1 to 10", out.width='100%'}
knitr::include_graphics(here("./Output/Spatial/zeta_declines_decays/wc/wc_zeta_decline_to_10.png"))
```

#### Habitat specialists, including sites with no species
```{r fig.cap = "Figure S5. Zeta diversity decline for habitat specialists, including sites with no species, zeta orders 1 to 10", out.width='100%'}
knitr::include_graphics(here("./Output/Spatial/zeta_declines_decays/hs/hs_zeta_decline_to_10.png"))
```

#### Habitat specialists, omitting sites with no species
```{r fig.cap = "Figure S6. Zeta diversity decline for habitat specialists, excluding sites with no species, zeta orders 1 to 10", out.width='100%'}
knitr::include_graphics(here("./Output/Spatial/zeta_declines_decays/hs_no_zeros/hs_no_zeros_zeta_decline_to_10.png"))
```

### Zeta orders 1 to 250

#### All species
```{r fig.cap = "Figure S7. Zeta diversity decline for all butterfly species, zeta orders 1 to 250", out.width='100%'}
knitr::include_graphics(here("./Output/Spatial/zeta_declines_decays/all_species/all_species_zeta_decline_to_250.png"))
```

#### Wider countryside species
```{r fig.cap = "Figure S8. Zeta diversity decline for wider countryside species, zeta orders 1 to 250", out.width='100%'}
knitr::include_graphics(here("./Output/Spatial/zeta_declines_decays/wc/wc_zeta_decline_to_250.png"))
```

## Comparison of exponential versus power Law fits to zeta decline
```{r, results='asis', message=FALSE}
for (i in 1:length(datasets)){
  my_file <- paste0("./Output/Spatial/zeta_declines_decays/", datasets[i], "/", 
                    datasets[i], "_zeta_declines_performance.csv")
  performance <-  read_csv(here(my_file))
  print(kable(performance, digits = 3,
             caption = paste0("Table S", i, " Comparison of exponential versus power law fits to zeta decline for ", dataset_names[i])))
}
```

## Comparison of zeta decline values
```{r, results='asis', message=FALSE}

for (i in 1:length(datasets)){
  my_file <- paste0("./Output/Spatial/zeta_declines_decays/", datasets[i], "/", datasets[i], "_zeta_decline_exact.csv")
zeta_div <-  read_csv(here(my_file))
print(kable(t(zeta_div), digits = 2,
             caption = paste0("Table S", i+4, " Comparison of zeta diversity values for ", dataset_names[i])))
}
```

## Zeta decays
#### All species
```{r fig.cap = "Figure S9. Zeta diversity decay with distance for All Butterfly Species", out.width='100%'}
knitr::include_graphics(here("./Output/Spatial/zeta_declines_decays/all_species/all_species_zeta_distance_decays.png"))
```

#### Wider countryside species
```{r fig.cap = "Figure S10. Zeta diversity decay with distance for Wider Countryside Species", out.width='100%'}
knitr::include_graphics(here("./Output/Spatial/zeta_declines_decays/wc/wc_zeta_distance_decays.png"))
```

#### Habitat specialists, including sites with no species
```{r fig.cap = "Figure S11. Zeta diversity decay with distance for Habitat Specialists including sites with no species", out.width='100%'}
knitr::include_graphics(here("./Output/Spatial/zeta_declines_decays/hs/hs_zeta_distance_decays.png"))
```

#### Habitat specialists, excluding sites with no species
```{r fig.cap = "Figure S12. Zeta diversity decay with distance for Habitat Specialists excluding sites with no species", out.width='100%'}
knitr::include_graphics(here("./Output/Spatial/zeta_declines_decays/hs_no_zeros/hs_no_zeros_zeta_distance_decays.png"))
```
